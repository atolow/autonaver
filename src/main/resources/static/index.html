<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ìë™í™” íˆ´ í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }
        
        .required {
            color: red;
        }
        
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        
        .result.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .result.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .result pre {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0,0,0,0.05);
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        
        .info {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            font-size: 14px;
            color: #0c5460;
        }
        
        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-size: 14px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .link-button {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .link-button:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ìë™í™” íˆ´</h1>
        <p class="subtitle">ë¸Œë¼ìš°ì €ì—ì„œ ê°„í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”</p>
        
        <div class="info">
            <strong>ğŸ“Œ ì‚¬ìš© ì „ í™•ì¸ì‚¬í•­:</strong><br>
            1. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤ (í¬íŠ¸ 8080)<br>
            2. <code>application.properties</code>ì— Client ID/Secretì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤<br>
            3. <strong>íŒë§¤ì ID í™•ì¸ ë°©ë²•:</strong><br>
               &nbsp;&nbsp;&nbsp;&nbsp;â†’ <a href="https://sell.smartstore.naver.com" target="_blank" style="color: #2196F3;">ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ íŒë§¤ìì„¼í„°</a> ë¡œê·¸ì¸<br>
               &nbsp;&nbsp;&nbsp;&nbsp;â†’ ìŠ¤í† ì–´ ì„¤ì • â†’ ìŠ¤í† ì–´ ì •ë³´ â†’ íŒë§¤ì ID í™•ì¸
        </div>
        
        <!-- Step 1: ìƒíƒœ í™•ì¸ -->
        <div class="section">
            <h2><span class="step-number">1</span>ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ í™•ì¸</h2>
            <p style="margin-bottom: 15px; color: #666; font-size: 14px;">
                ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.
            </p>
            <button onclick="checkStatus()">ìƒíƒœ í™•ì¸</button>
            <div id="statusResult" class="result"></div>
        </div>
        
        <!-- Step 2: ìŠ¤í† ì–´ ë“±ë¡ -->
        <div class="section">
            <h2><span class="step-number">2</span>ìŠ¤í† ì–´ ë“±ë¡ / í† í° ê°±ì‹ </h2>
            <p style="margin-bottom: 15px; color: #666; font-size: 14px;">
                <strong>âœ¨ ìë™ ëª¨ë“œ:</strong> ìŠ¤í† ì–´ê°€ ì´ë¯¸ ë“±ë¡ë˜ì–´ ìˆìœ¼ë©´ ì €ì¥ëœ ì •ë³´ë¡œ ìë™ í† í° ê°±ì‹ í•©ë‹ˆë‹¤.<br>
                <strong>ğŸ“ ìµœì´ˆ ì„¤ì •:</strong> ìŠ¤í† ì–´ê°€ ì—†ìœ¼ë©´ ìµœì´ˆ 1íšŒë§Œ íŒë§¤ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.
            </p>
            
            <div class="info" id="storeInfo" style="display: none;">
                <strong>â„¹ï¸ í˜„ì¬ ë“±ë¡ëœ ìŠ¤í† ì–´ê°€ ìˆìŠµë‹ˆë‹¤.</strong><br>
                ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì €ì¥ëœ ì •ë³´ë¡œ ìë™ í† í° ê°±ì‹ ì´ ì§„í–‰ë©ë‹ˆë‹¤.
            </div>
            
            <div id="firstTimeSetup" style="display: none;">
                <div class="form-group">
                    <label>ì¸ì¦ íƒ€ì…</label>
                    <select id="type">
                        <option value="SELF" selected>SELF (íŒë§¤ì ë¦¬ì†ŒìŠ¤)</option>
                    </select>
                    <small style="color: #666; font-size: 12px;">ê¸°ë³¸ê°’: SELF</small>
                </div>
                
                <div class="form-group">
                    <label>íŒë§¤ì ID (accountId) <span class="required">*</span></label>
                    <input type="text" id="accountId" placeholder="ì˜ˆ: ncp_2sRZTWJVbDtHPoz9OXXXX">
                    <small style="color: #666; font-size: 12px; line-height: 1.6;">
                        <strong>ğŸ“Œ íŒë§¤ì ID í™•ì¸ ë°©ë²•:</strong><br>
                        1. <a href="https://sell.smartstore.naver.com" target="_blank" style="color: #667eea;">ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ íŒë§¤ìì„¼í„°</a> ë¡œê·¸ì¸<br>
                        2. <strong>ìŠ¤í† ì–´ ì„¤ì •</strong> â†’ <strong>ìŠ¤í† ì–´ ì •ë³´</strong> ë©”ë‰´ í´ë¦­<br>
                        3. <strong>íŒë§¤ì ID</strong> ë˜ëŠ” <strong>ìŠ¤í† ì–´ ID</strong> í™•ì¸<br>
                        <br>
                        âš ï¸ <strong>ì£¼ì˜:</strong> Client ID (ì˜ˆ: 7gz2KKBlKrNUFaAOt1urVB)ê°€ ì•„ë‹Œ<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì‹¤ì œ <strong>íŒë§¤ì ID</strong>ë¥¼ ì…ë ¥í•˜ì„¸ìš”!
                    </small>
                </div>
                

            </div>
            
            <button onclick="registerStore()" id="registerButton">í† í° ë°œê¸‰ / ê°±ì‹ </button>
            <div id="storeResult" class="result"></div>
        </div>
        
        <!-- Step 3: ìŠ¤í† ì–´ ì¡°íšŒ -->
        <div class="section">
            <h2><span class="step-number">3</span>ë“±ë¡ëœ ìŠ¤í† ì–´ í™•ì¸</h2>
            <p style="margin-bottom: 15px; color: #666; font-size: 14px;">
                í˜„ì¬ ë“±ë¡ëœ ìŠ¤í† ì–´ ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
            </p>
            <button onclick="getStore()">ìŠ¤í† ì–´ ì¡°íšŒ</button>
            <div id="getStoreResult" class="result"></div>
        </div>
        
        <!-- Step 4: ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ -->
        <div class="section">
            <h2><span class="step-number">4</span>ì—‘ì…€ íŒŒì¼ë¡œ ìƒí’ˆ ì¼ê´„ ì—…ë¡œë“œ</h2>
            <p style="margin-bottom: 15px; color: #666; font-size: 14px;">
                ì—‘ì…€ íŒŒì¼(.xlsx)ì„ ì—…ë¡œë“œí•˜ì—¬ ë„¤ì´ë²„ ìŠ¤í† ì–´ì— ìƒí’ˆì„ ìë™ìœ¼ë¡œ ë“±ë¡í•©ë‹ˆë‹¤.
            </p>
            
            <div class="info">
                <strong>ğŸ“‹ ì—‘ì…€ íŒŒì¼ í˜•ì‹:</strong><br>
                í•„ìˆ˜ ì»¬ëŸ¼: ìƒí’ˆëª…, ì¹´í…Œê³ ë¦¬, íŒë§¤ê°€, ì¬ê³ ìˆ˜ëŸ‰, ìƒì„¸ì„¤ëª…, ëŒ€í‘œì´ë¯¸ì§€URL<br>
                ì„ íƒ ì»¬ëŸ¼: ì¶”ê°€ì´ë¯¸ì§€URL1, ë°°ì†¡ë¹„, ë°°ì†¡ë°©ë²•, ë¸Œëœë“œ, ëª¨ë¸ëª…, ì œì¡°ì‚¬, ì›ì‚°ì§€, ê³¼ì„¸êµ¬ë¶„, íŒë§¤ìƒíƒœ, ì „ì‹œìƒíƒœ
            </div>
            
            <div class="form-group">
                <label>ì—‘ì…€ íŒŒì¼ ì„ íƒ <span class="required">*</span></label>
                <input type="file" id="excelFile" accept=".xlsx,.xls" style="padding: 8px;">
                <small style="color: #666; font-size: 12px;">.xlsx ë˜ëŠ” .xls íŒŒì¼ë§Œ ì§€ì›</small>
            </div>
            
            <button onclick="uploadExcel()" id="uploadButton">ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</button>
            <div id="uploadResult" class="result"></div>

        </div>
    </div>
    
    <script>
        const API_BASE_URL = 'http://localhost:8080';
        
        // Step 1: ìƒíƒœ í™•ì¸
        async function checkStatus() {
            const resultDiv = document.getElementById('statusResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.innerHTML = '<p>í™•ì¸ ì¤‘...</p>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/stores`);
                
                if (response.status === 404) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '<p>âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤!</p><p style="margin-top: 10px;">ìŠ¤í† ì–´ê°€ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Step 2ë¡œ ì§„í–‰í•˜ì„¸ìš”.</p>';
                } else if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '<p>âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤!</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì˜¤ë¥˜ ë°œìƒ:</p><pre>' + error.message + '</pre><p style="margin-top: 10px;">ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.</p>';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŠ¤í† ì–´ ìƒíƒœ í™•ì¸
        window.addEventListener('DOMContentLoaded', async function() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/stores`);
                if (response.ok) {
                    // ìŠ¤í† ì–´ê°€ ìˆìœ¼ë©´ ìë™ ëª¨ë“œ í‘œì‹œ
                    const store = await response.json();
                    document.getElementById('storeInfo').style.display = 'block';
                    document.getElementById('firstTimeSetup').style.display = 'none';
                    document.getElementById('registerButton').textContent = 'í† í° ê°±ì‹  (ìë™)';
                } else {
                    // ìŠ¤í† ì–´ê°€ ì—†ìœ¼ë©´ ìµœì´ˆ ì„¤ì • ëª¨ë“œ í‘œì‹œ
                    document.getElementById('storeInfo').style.display = 'none';
                    document.getElementById('firstTimeSetup').style.display = 'block';
                    document.getElementById('registerButton').textContent = 'ìŠ¤í† ì–´ ë“±ë¡';
                }
            } catch (error) {
                // ì—ëŸ¬ ë°œìƒ ì‹œ ìµœì´ˆ ì„¤ì • ëª¨ë“œ í‘œì‹œ
                document.getElementById('storeInfo').style.display = 'none';
                document.getElementById('firstTimeSetup').style.display = 'block';
                document.getElementById('registerButton').textContent = 'ìŠ¤í† ì–´ ë“±ë¡';
            }
        });
        
        // Step 2: ìŠ¤í† ì–´ ë“±ë¡ / í† í° ê°±ì‹ 
        async function registerStore() {
            const resultDiv = document.getElementById('storeResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.innerHTML = '<p>ì²˜ë¦¬ ì¤‘...</p>';
            
            const type = document.getElementById('type') ? document.getElementById('type').value : null;
            const accountId = document.getElementById('accountId') ? document.getElementById('accountId').value.trim() : null;
            const vendorId = document.getElementById('vendorId') ? document.getElementById('vendorId').value.trim() : null;
            const storeName = document.getElementById('storeName') ? document.getElementById('storeName').value.trim() : null;
            
            // ì…ë ¥ê°’ ê²€ì¦ (ìµœì´ˆ ì„¤ì • ì‹œì—ë§Œ)
            if (accountId) {
                if (accountId.includes('7gz2KKBlKrNUFaAOt1urVB') || accountId.startsWith('$2a$')) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<p>âŒ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤!</p><p style="margin-top: 10px;">accountIdì—ëŠ” Client IDê°€ ì•„ë‹Œ <strong>ì‹¤ì œ íŒë§¤ì ID</strong>ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p><p>íŒë§¤ì IDëŠ” ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ íŒë§¤ìì„¼í„°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>';
                    return;
                }
            }
            
            if (vendorId && vendorId.startsWith('$2a$')) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤!</p><p style="margin-top: 10px;">vendorIdì—ëŠ” Client Secretì´ ì•„ë‹Œ <strong>íŒë§¤ì ID</strong>ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>';
                return;
            }
            
            // FormData ìƒì„± (ê°’ì´ ìˆëŠ” ê²ƒë§Œ ì¶”ê°€)
            const formData = new URLSearchParams();
            if (type) formData.append('type', type);
            if (accountId) formData.append('accountId', accountId);
            if (vendorId) formData.append('vendorId', vendorId);
            if (storeName) formData.append('storeName', storeName);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/oauth/authenticate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: formData.toString()
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    const isNewStore = !document.getElementById('storeInfo').style.display || 
                                      document.getElementById('storeInfo').style.display === 'none';
                    resultDiv.innerHTML = '<p>âœ… ' + (isNewStore ? 'ìŠ¤í† ì–´ ë“±ë¡' : 'í† í° ê°±ì‹ ') + ' ì„±ê³µ!</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                    
                    // ì„±ê³µ í›„ UI ì—…ë°ì´íŠ¸
                    document.getElementById('storeInfo').style.display = 'block';
                    document.getElementById('firstTimeSetup').style.display = 'none';
                    document.getElementById('registerButton').textContent = 'í† í° ê°±ì‹  (ìë™)';
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<p>âŒ ì²˜ë¦¬ ì‹¤íŒ¨:</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì˜¤ë¥˜ ë°œìƒ:</p><pre>' + error.message + '</pre>';
            }
        }
        
        // Step 3: ìŠ¤í† ì–´ ì¡°íšŒ
        async function getStore() {
            const resultDiv = document.getElementById('getStoreResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.innerHTML = '<p>ì¡°íšŒ ì¤‘...</p>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/stores`);
                
                if (response.status === 404) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<p>âŒ ë“±ë¡ëœ ìŠ¤í† ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p><p style="margin-top: 10px;">Step 2ì—ì„œ ìŠ¤í† ì–´ë¥¼ ë¨¼ì € ë“±ë¡í•˜ì„¸ìš”.</p>';
                } else if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '<p>âœ… ìŠ¤í† ì–´ ì •ë³´:</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì˜¤ë¥˜ ë°œìƒ:</p><pre>' + error.message + '</pre>';
            }
        }
        
        // Step 4: ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ
        async function uploadExcel() {
            const fileInput = document.getElementById('excelFile');
            const resultDiv = document.getElementById('uploadResult');
            const uploadButton = document.getElementById('uploadButton');
            
            if (!fileInput.files || fileInput.files.length === 0) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>';
                return;
            }
            
            const file = fileInput.files[0];
            
            // íŒŒì¼ í˜•ì‹ ê²€ì¦
            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì—‘ì…€ íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (.xlsx ë˜ëŠ” .xls íŒŒì¼ë§Œ ì§€ì›)</p>';
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.innerHTML = '<p>ì—…ë¡œë“œ ì¤‘... (íŒŒì¼ í¬ê¸°ì— ë”°ë¼ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</p>';
            uploadButton.disabled = true;
            uploadButton.textContent = 'ì—…ë¡œë“œ ì¤‘...';
            
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/products/upload-excel`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    const successCount = data.successCount || 0;
                    const failureCount = data.failureCount || 0;
                    const totalCount = data.totalCount || 0;
                    
                    let html = `<p>âœ… ì—…ë¡œë“œ ì™„ë£Œ!</p>`;
                    html += `<p style="margin-top: 10px;"><strong>ì´ ${totalCount}ê°œ</strong> | `;
                    html += `<span style="color: #28a745;">ì„±ê³µ ${successCount}ê°œ</span> | `;
                    html += `<span style="color: #dc3545;">ì‹¤íŒ¨ ${failureCount}ê°œ</span></p>`;
                    
                    if (data.successItems && data.successItems.length > 0) {
                        html += `<p style="margin-top: 15px;"><strong>âœ… ì„±ê³µí•œ ìƒí’ˆ:</strong></p>`;
                        html += `<ul style="margin-left: 20px; margin-top: 5px;">`;
                        data.successItems.forEach(item => {
                            html += `<li>í–‰ ${item.rowNumber}: ${item.productName || 'ì´ë¦„ ì—†ìŒ'}</li>`;
                        });
                        html += `</ul>`;
                    }
                    
                    if (data.failureItems && data.failureItems.length > 0) {
                        html += `<p style="margin-top: 15px;"><strong>âŒ ì‹¤íŒ¨í•œ ìƒí’ˆ:</strong></p>`;
                        html += `<ul style="margin-left: 20px; margin-top: 5px;">`;
                        data.failureItems.forEach(item => {
                            html += `<li>í–‰ ${item.rowNumber}: ${item.productName || 'ì´ë¦„ ì—†ìŒ'} - ${item.errorMessage}</li>`;
                        });
                        html += `</ul>`;
                    }
                    
                    html += `<p style="margin-top: 15px;"><strong>ì „ì²´ ê²°ê³¼:</strong></p>`;
                    html += `<pre style="max-height: 300px; overflow-y: auto;">${JSON.stringify(data, null, 2)}</pre>`;
                    
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<p>âŒ ì—…ë¡œë“œ ì‹¤íŒ¨:</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<p>âŒ ì˜¤ë¥˜ ë°œìƒ:</p><pre>' + error.message + '</pre>';
            } finally {
                uploadButton.disabled = false;
                uploadButton.textContent = 'ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ';
            }
        }
    </script>
</body>
</html>

